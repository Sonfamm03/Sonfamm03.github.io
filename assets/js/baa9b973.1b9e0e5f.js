"use strict";(self.webpackChunkmirai_sdk_doc=self.webpackChunkmirai_sdk_doc||[]).push([[523],{7788:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>o});var i=r(5893),t=r(1151);const s={slug:"/integrations/external"},d=void 0,a={id:"Types of Integrations /External Integration",title:"External Integration",description:"This integration process is designed to be efficient and straightforward, requiring minimal effort from our partners. There is no need to integrate extensive SDK features and the guild management UI will be seamlessly provided by the Shards app. Partners are only required to link their profile through our Portal, reducing friction in user experience.",source:"@site/docs/3. Types of Integrations /2. External Integration.md",sourceDirName:"3. Types of Integrations ",slug:"/integrations/external",permalink:"/integrations/external",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{slug:"/integrations/external"},sidebar:"defaultSidebar",previous:{title:"Prerequisites",permalink:"/integrations"},next:{title:"Partial Integration",permalink:"/integrations/partial"}},l={},o=[{value:"Process",id:"process",level:2},{value:"Step 1: Create account in self-integration portal",id:"step-1-create-account-in-self-integration-portal",level:3},{value:"Step 2: Install SDK package based on game engine",id:"step-2-install-sdk-package-based-on-game-engine",level:3},{value:"Step 3: Link profile",id:"step-3-link-profile",level:3},{value:"Option 1: By <code>MiraiId</code>",id:"option-1-by-miraiid",level:4},{value:"Option 2: By <code>userGameId</code>",id:"option-2-by-usergameid",level:4},{value:"Step 4: Set up game server",id:"step-4-set-up-game-server",level:3},{value:"Example",id:"example",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"This integration process is designed to be efficient and straightforward, requiring minimal effort from our partners. There is no need to integrate extensive SDK features and the guild management UI will be seamlessly provided by the Shards app. Partners are only required to link their profile through our Portal, reducing friction in user experience."}),"\n",(0,i.jsx)(n.h2,{id:"process",children:"Process"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-create-account-in-self-integration-portal",children:"Step 1: Create account in self-integration portal"}),"\n",(0,i.jsxs)(n.p,{children:["Refer to the ",(0,i.jsx)(n.a,{href:"../integrations#environment-setup",children:(0,i.jsx)("ins",{children:(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Environment setup"})})})})," section for more details"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-install-sdk-package-based-on-game-engine",children:"Step 2: Install SDK package based on game engine"}),"\n",(0,i.jsxs)(n.p,{children:["Refer to the ",(0,i.jsx)(n.a,{href:"../integrations#game-client",children:(0,i.jsx)("ins",{children:(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Game Client"})})})})," section for more details"]}),"\n",(0,i.jsx)(n.h3,{id:"step-3-link-profile",children:"Step 3: Link profile"}),"\n",(0,i.jsxs)(n.p,{children:["Partner can either link profile using ",(0,i.jsx)(n.code,{children:"MiraiId"})," or ",(0,i.jsx)(n.code,{children:"userGameId"})]}),"\n",(0,i.jsxs)(n.h4,{id:"option-1-by-miraiid",children:["Option 1: By ",(0,i.jsx)(n.code,{children:"MiraiId"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Link profile API"})}),"\n",(0,i.jsx)(n.p,{children:"We provide an API for the linking feature with details given below"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Endpoint: ",(0,i.jsx)(n.code,{children:"PUT /v1/user-mirai/add-mirai"})]}),"\n",(0,i.jsxs)(n.li,{children:["Authorization","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Guarded by ",(0,i.jsx)(n.code,{children:"ApiKeyGuard"})]}),"\n",(0,i.jsxs)(n.li,{children:["Requires Api key (",(0,i.jsx)(n.code,{children:"api-key"}),")"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Headers","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"api-key"}),": ",(0,i.jsx)(n.code,{children:"<api_key>"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Request Body: The request body should be a JSON object with the following fields"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "userId": "User ID in partner\'s game",\n  "miraiId": "User Mirai ID",\n  "clientId": "The ID of the game client"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step-by-step guide"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Partners should prepare an UI for the linking function, entering user ",(0,i.jsx)(n.code,{children:"MiraiId"})]}),"\n",(0,i.jsxs)(n.li,{children:["As user confirmed, the ",(0,i.jsx)(n.strong,{children:"Link profile API"})," should be called"]}),"\n",(0,i.jsx)(n.li,{children:"On success, user should be redirected to Game details page on Shards App for guild management"}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"option-2-by-usergameid",children:["Option 2: By ",(0,i.jsx)(n.code,{children:"userGameId"})]}),"\n",(0,i.jsxs)(n.p,{children:["As partner creates a new game, it's assigned a random key used to encode in-game user ID in field ",(0,i.jsx)(n.code,{children:"encodeUserIdKey"})," (More info in this\n",(0,i.jsx)("a",{href:"https://api.shards.tech/swagger#/Game%20Client%20Query/GameConfigController_getGameConfig",style:{color:"#007bff",textDecoration:"underline"},target:"_blank",children:"API"}),"). We're using ",(0,i.jsx)(n.strong,{children:"AES-256-CBC"})," encryption algorithm to encode game user ID, here are some implementations in different languages that partner can refer to"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsxs)("summary",{children:[" ",(0,i.jsx)("b",{children:" Javascript "})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const crypto = require('crypto');\n\nconst IV_LENGTH = 16; // For AES\n\n// `text` equals plain game user ID\nfunction encrypt(text) {\n  // This is the encode key from `encodeUserIdKey` field\n  const encryptKey = 'VlbEROErE26MHoKdKEMgM2kgeWobvNjr';\n  const iv = crypto.randomBytes(IV_LENGTH);\n  const cipher = crypto.createCipheriv(\n    'aes-256-cbc',\n    Buffer.from(encryptKey),\n    iv\n  );\n  let encrypted = cipher.update(text);\n  encrypted = Buffer.concat([encrypted, cipher.final()]);\n  return `${iv.toString('hex')}:${encrypted.toString('hex')}`;\n}\n\n"})})]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsxs)("summary",{children:[" ",(0,i.jsx)("b",{children:"Python"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import base64\nimport os\nfrom Crypto.Cipher import AES\nfrom Crypto.Util.Padding import pad\n\nIV_LENGTH = 16  # For AES\n\n# `text` equals plain game user ID\ndef encrypt(text):\n    # This is the encode key from `encodeUserIdKey` field\n    encrypt_key = b'VlbEROErE26MHoKdKEMgM2kgeWobvNjr'\n    iv = os.urandom(IV_LENGTH)\n    cipher = AES.new(encrypt_key, AES.MODE_CBC, iv)\n    encrypted = cipher.encrypt(pad(text.encode('utf-8'), AES.block_size))\n    return f\"{iv.hex()}:{encrypted.hex()}\"\n"})})]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsxs)("summary",{children:[" ",(0,i.jsx)("b",{children:"PHP"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// `text` equals plain game user ID\nfunction encrypt($text) {\n    // This is the encode key from `encodeUserIdKey` field\n    $encryptKey = 'VlbEROErE26MHoKdKEMgM2kgeWobvNjr';\n    $ivLength = openssl_cipher_iv_length('aes-256-cbc');\n    $iv = openssl_random_pseudo_bytes($ivLength);\n    $encrypted = openssl_encrypt($text, 'aes-256-cbc', $encryptKey, 0, $iv);\n    return bin2hex($iv) . ':' . bin2hex(base64_decode($encrypted));\n}\n\n"})})]}),"\n",(0,i.jsxs)(n.p,{children:["Therefore, the linking feature can easily be arranged in the Shards App where user only need to provide the encoded ",(0,i.jsx)(n.code,{children:"userGameId"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Image",src:r(4664).Z+"",width:"1114",height:"810"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"Both options can be implemented simultaneously, partner can freely choose which suits them best"})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-set-up-game-server",children:"Step 4: Set up game server"}),"\n",(0,i.jsxs)(n.p,{children:["Refer to the ",(0,i.jsx)(n.a,{href:"../integrations#game-server",children:(0,i.jsx)("ins",{children:(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Game Server"})})})})," section for more details"]}),"\n",(0,i.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.th,{style:{textAlign:"center"},children:(0,i.jsx)(n.img,{alt:"Image",src:r(4591).Z+"",width:"1920",height:"1714"})})})}),(0,i.jsx)(n.tbody,{children:(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{style:{textAlign:"center"},children:(0,i.jsx)(n.strong,{children:"Game List"})})})})]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.th,{style:{textAlign:"center"},children:(0,i.jsx)(n.img,{alt:"Image",src:r(183).Z+"",width:"1920",height:"1250"})})})}),(0,i.jsx)(n.tbody,{children:(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{style:{textAlign:"center"},children:(0,i.jsx)(n.strong,{children:"Create new guild"})})})})]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.th,{style:{textAlign:"center"},children:(0,i.jsx)(n.img,{alt:"Image",src:r(954).Z+"",width:"2074",height:"1358"})})})}),(0,i.jsx)(n.tbody,{children:(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{style:{textAlign:"center"},children:(0,i.jsx)(n.strong,{children:"Guild Details"})})})})]})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},183:(e,n,r)=>{r.d(n,{Z:()=>i});const i=r.p+"assets/images/GM_CreateGuild-e122cc04b943ab667afc75c821f4820e.png"},4591:(e,n,r)=>{r.d(n,{Z:()=>i});const i=r.p+"assets/images/GM_GameList-e48d5ea11c9e45566ab27ab6447a86a9.png"},954:(e,n,r)=>{r.d(n,{Z:()=>i});const i=r.p+"assets/images/GM_GuildDetails-71fca9da93f4327e2bbeba6808c0ffda.png"},4664:(e,n,r)=>{r.d(n,{Z:()=>i});const i=r.p+"assets/images/LinkProfileUI-ec6b4c8aff610d1f87dd3ad0e1ad7ddc.png"},1151:(e,n,r)=>{r.d(n,{Z:()=>a,a:()=>d});var i=r(7294);const t={},s=i.createContext(t);function d(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);